{
  "_from": "simple-svg-tools",
  "_id": "simple-svg-tools@1.1.12",
  "_inBundle": false,
  "_integrity": "sha512-IFzkoAwOsE7F0J3FODgMXZ+Tvb8Tm/1X+jmQAkR2bRtet24GQrrvnhLtS3alZ6crCc27tLuuKYajjruRehKeqg==",
  "_location": "/simple-svg-tools",
  "_phantomChildren": {},
  "_requested": {
    "escapedName": "simple-svg-tools",
    "fetchSpec": "latest",
    "name": "simple-svg-tools",
    "raw": "simple-svg-tools",
    "rawSpec": "",
    "registry": true,
    "saveSpec": null,
    "type": "tag"
  },
  "_requiredBy": [
    "#USER",
    "/"
  ],
  "_resolved": "https://registry.npmjs.org/simple-svg-tools/-/simple-svg-tools-1.1.12.tgz",
  "_shasum": "8274ba4de58cca2392169829b4e70b2e74164517",
  "_shrinkwrap": null,
  "_spec": "simple-svg-tools",
  "_where": "/home/alex/projects/pdi-svg-generator",
  "author": {
    "name": "Vjacheslav Trushkin"
  },
  "bundleDependencies": false,
  "dependencies": {
    "cheerio": "^0.22.0",
    "cyberalien-color": "*",
    "simple-tokenizer": "*",
    "svgo": "^1.0.1",
    "tmp": "0.0.31"
  },
  "deprecated": false,
  "description": "Collection of functions for cleaning up and parsing SVG images",
  "devDependencies": {
    "chai": "*",
    "mocha": "*"
  },
  "license": "MIT",
  "main": "src/modules.js",
  "name": "simple-svg-tools",
  "optionalDependencies": {},
  "readme": "# SimpleSVG Tools\n\nThis library is a collection of tools for importing, exporting and processing SVG images.\n\n## Installation\n\nFirst install it by running this command:\n\n    npm install simple-svg-tools --save\n\nThen you can use it in your Node.js files:\n\n    const tools = require('simple-svg-tools');\n\n## What tools are available?\n\n* Import SVG from various sources\n* Export SVG to various formats\n* Optimize images\n* Crop images\n* Clean up images\n* Get/change color palette\n* Find shapes, get lengths of shapes\n* Convert shapes to paths\n\n## Core\n\nCore of tools are SVG and Collections classes. All tools create or manipulate instances of SVG or Collection classes.\n\nAll tools are based on Promises. If you are not familiar with JavaScript Promises, do read up. There are many tutorials\navailable online. Make sure you are reading something from 2016 or newer, not tutorials for old implementations.\n\n### SVG class\n\nSVG class represents one SVG image. It is a simple class, it does not manipulate anything, except for\ncleaning up junk code that could otherwise cause XML parser to fail.\n\nYou can find code in src/svg.js\n\nCreating SVG instance is easy:\n\n    let svg = new tools.SVG('<svg ...></svg>');\n\nThat code will load SVG from string, extract image dimensions and clean up a bit, removing all junk image editors left\nbehind.\n\nSVG instance has multiple methods to get SVG as string:\n\n* svg.toString() - returns SVG as string\n* svg.toMinifiedString() - same as toString(), but without white spaces\n* svg.getBody() - returns body as string: child elements of `<svg>` element.\n\nThen you can get dimensions:\n\n* svg.getDimensions() - returns object containing width and height properties\n* svg.width - returns width\n* svg.height - returns height\n\nLast method replaces content of SVG instance:\n\n* svg.load(content) - same as constructor, but instead of making new instance it changes existing instance.\n\nYou can see usage examples in unit tests: tests/core/svg_test.js\n\n### Collection class\n\nCollection is a set of SVG instances.\n\nYou can find code in src/collection.js\n\nTo create Collection instance use this:\n\n    let collection = new tools.Collection();\n\nThat will create empty collection.\n\nTo clone another collection add collection as parameter to constructor:\n\n    let newCollection = new tools.Collection(oldCollection);\n\nTo add/remove items there are several methods:\n\n* collection.add('icon-name', svg) - add new item to collection\n* collection.remove('icon-name') - remove item from collection\n* collection.rename('old-name', 'new-name') - rename item\n\nwhere \"svg\" is instance of SVG class\n\nTo access any item use this:\n\n* collection.items['item-name']\n\nThere are other helpful functions:\n\n* collection.length() - returns number of items in collection\n* collection.keys() - returns list of all icon names\n\nThen there are main functions that are used to manipulate SVG instances in collection:\n\n* collection.forEach(callback) - iterates through all SVG instances. Callback function arguments: (svg, name), where svg is SVG instance, name is icon name.\n* collection.promiseAll(promise) - runs promise on all items in collection.\n\nHow to use forEach():\n\n    collection.forEach((svg, name) {\n        console.log('Found icon ' + name + ': ' + svg.toString());\n    });\n\nHow to use promiseAll():\n\n    collection.promiseAll((svg, name) => {\n        return new Promise((fulfill, reject) {\n            // do stuff to \"svg\" variable\n            fulfill('Result for icon ' + name);\n        });\n    }).then(results => {\n        // Results of all promises as object. Key = icon name, value = result for that icon\n\n        Object.keys(results).forEach(name => {\n            console.log('Result for icon ' + name + ':', results[name]);\n        });\n    }).catch(err => {\n        console.log('Promise failed:', err);\n    });\n\nYou can find examples throughout this library and unit tests. Everything in this library is based on promises.\n\n## Importing\n\nThere are several importers available. Some import one file, some import collections.\n\n### Importing one SVG file\n\n    tools.ImportSVG('path-to-file.svg').then(svg => {\n        // SVG was imported\n        // Variable 'svg' is instance of SVG class\n        console.log(svg.toString());\n    }).catch(err => {\n        console.log(err);\n    });\n\n### Importing directory\n\n    tools.ImportDir('directory').then(collection => {\n        // Collection was imported\n        // Variable 'collection' is instance of Collection class\n        console.log('Found icons: ' + collection.keys().join(', '));\n    }).catch(err => {\n        console.log(err);\n    });\n\nThere are several options available for importing directory, options should be passed as second parameter to ImportDir\nfunction:\n\n* 'include-subdirs' - check subdirectories. Default = true\n* keywordCallback - custom callback to get image name from file. It is a function with 2 arguments: function(file_without_extension, filename). Function should return string. See default function in src/import/dir.js for example\n* ignoreDuplicates - if true, when files with duplicate keywords are found script will log a error message.\n* ignoreFiles - array of files to ignore. Values are keywords, not file names.\n* contentCallback - callback to change content. Use it if content contains some weird stuff you need to remove before importing SVG. function(content). Function should return modified content as string.\n\n    tools.ImportDir('directory', {\n        'include-subdirs': false,\n        ignoreFiles: ['bad-icon'],\n        keywordCallback: (file, filename) => 'prefix-' + file\n    }).then(collection => {\n        // Collection was imported\n        // Variable 'collection' is instance of Collection class\n        console.log('Found icons: ' + collection.keys().join(', '));\n    }).catch(err => {\n        console.log(err);\n    });\n\n### Importing WebIcon\n\nWebIcon format is one big SVG image that contains multiple images.\n\n    tools.ImportWebIcon('path-to-file.svg').then(collection => {\n        // Collection was imported\n        // Variable 'collection' is instance of Collection class\n        console.log('Found icons: ' + collection.keys().join(', '));\n    }).catch(err => {\n        console.log(err);\n    });\n\n### Importing SVG font\n\nThere are many popular glyph fonts, such as FontAwesome, that are not available as individual files. This importer will\nimport SVG font as collection. It will not import keywords though for each icon - that is different for every\ncollection and should be done separately.\n\n    tools.ImportFont('path-to-file.svg').then(collection => {\n        // Collection was imported\n        // Variable 'collection' is instance of Collection class\n        console.log('Found icons: ' + collection.keys().join(', '));\n    }).catch(err => {\n        console.log(err);\n    });\n\nThere are several options available for importing SVG font, options should be passed as second parameter to ImportFont\nfunction:\n\n* ignoreCharacters - list of characters to ignore. Array\n* characterChanges - changes for each character, object. Key is character's hexadecimal code, value is list of changes for that character.\n* fontChanges - changes for all characters\n\nKeys for characterChanges and fontChanges objects are similar:\n\n* height, width - custom height and width\n* left, bottom - custom left and bottom indexes. Why bottom instead of top? SVG fonts flip icons vertically, so height is counted from bottom\n\nEach value can be a number or a function(oldValue) that should return new value.\n\nExample:\n\n    tools.ImportFont('path-to-file.svg', {\n        fontChanges: {\n            height = height => Math.ceil(height / 16) * 16 // Round up height to 16px grid\n        },\n        characterChanges: {\n            f19c: { width: 1920 },\n            f0fc: { left: 64, width: 1600 },\n        }\n    }).then(collection => {\n        // Collection was imported\n        // Variable 'collection' is instance of Collection class\n        console.log('Found icons: ' + collection.keys().join(', '));\n    }).catch(err => {\n        console.log(err);\n    });\n\nIf you are going to crop images after import, there is no point in worrying about fixing characters. Crop will fix it (unless font is really badly messed up).\n\n## Exporting\n\nThere are several exporters available that work with Collection or SVG instances:\n\n### Exporting SVG\n\nExports one SVG instance.\n\n    tools.ExportSVG(svg, 'filename.svg').then(() => {\n        console.log('Exported!');\n    }).catch(err => {\n        console.log(err);\n    });\n\n### Exporting collection to directory\n\n    tools.ExportDir(collection, 'directory').then(count => {\n        console.log('Exported ' + count + ' files');\n    }).catch(err => {\n        console.log(err);\n    });\n\n### Exporting collection to JSON file\n\nThis is main export function, it exports collection to JSON format used by SimpleSVG.\n\n    tools.ExportJSON(collection, 'filename.json').then(json => {\n        console.log('Exported collection. JSON data: ' + JSON.stringify(json));\n    }).catch(err => {\n        console.log(err);\n    });\n\n## Manipulating\n\nMost functions require SVG to be optimized. Therefore before doing anything else, you should optimize icon.\n\n### SVGO optimization\n\nThis module optimizes SVG images, removing any unnecessary code and cleaning up stuff. It does not merge shapes to avoid\npotential problems with images that rely on specific order of shapes.\n\n    tools.SVGO(svg).then(svg => {\n        // svg variable is the same as in argument. Optimizer does not create new instance of SVG class\n        console.log('Optimized SVG');\n    }).catch(err => {\n        console.log(err);\n    });\n\nWant to optimize entire collection? Use collection's promiseAll function:\n\n    collection.promiseAll(svg => tools.SVGO(svg)).then(results => {\n        console.log('Optimized entire collection');\n    }).catch(err => {\n        console.log(err);\n    });\n\n### Cropping images\n\nThis module crops SVG icons imported from fonts.\n\nImportant! This function requires PhantomJS to be installed. See http://phantomjs.org/\n\nHow to crop one image:\n\n    tools.Crop(svg).then(svg => {\n        console.log('Cropped SVG: ' + svg.toString());\n    }).catch(err => {\n        console.log(err);\n    });\n\nHow to crop entire collection:\n\n    tools.Crop(colleciton).then(colleciton => {\n        console.log('Cropped ' + svg.length() + ' images');\n    }).catch(err => {\n        console.log(err);\n    });\n\nHow does crop work? By drawing SVG on canvas and checking all 4 sides for transparent pixels. First it appends space on\nall sides of SVG, until all sides have nothing but empty pixels. Then it slowly cuts all sides until it reaches pixels\nthat aren't empty. Process doesn't take long because script checks pixels in bulk by zooming in.\n\nWhen it crops SVG or Collection instance (like in examples above), each SVG instance receives additional properties\nthat you might want to use later: _cropData. _cropData is an object with list of cropped edges: left, top, right, bottom.\n\nNode.js is not a browser, it does not support canvas and cannot render SVG images. Because of that calculations are\ndone in PhantomJS and script requires PhantomJS to be installed.\n\n### Tags validation\n\nThis module checks elements used in SVG image, changes stylesheet into inline style and removes useless attributes.\n\nStylesheet parser is very simple, it parses only basic stylesheets that are generated by some image editors. If SVG\ncontains fishy elements that aren't vector images, such as bitmaps or scripts, it will reject with error message.\n\nImportant! Before running this function you need to optimize SVG image using tools.SVGO()\n\nUsage:\n\n    tools.Tags(svg).then(svg => {\n        console.log('Cleaned up tags in SVG: ' + svg.toString());\n    }).catch(err => {\n        console.log(err);\n    });\n\nThis function is used for optimizing SVG images that contain a lot of junk code.\n\n### Extracting palette from SVG\n\nIf you don't know if SVG is colored or monotone or maybe doesn't have any colors at all, this tool will find all colors\nused in SVG and return you array of used colors.\n\nResult is object with 2 properties:\n\n* colors - array of color strings\n* notices - array of error messages\n\nUsage:\n\n    tools.GetPalette(svg).then(result => {\n        console.log('Colors used in SVG: ' + result.colors.join(', ');\n        if (result.notices.length) {\n            result.notices.forEach(notice => console.log(notice));\n        }\n    }).catch(err => {\n        console.log(err);\n    });\n\nUsing it with collection:\n\n    collection.promiseAll(svg => tools.GetPalette(svg)).then(result => {\n        Object.keys(results).forEach(key => {\n            console.log('Colors found in image ' + key + ': ' + result[key].colors.join(', ');\n        });\n    }).catch(err => {\n        console.log(err);\n    });\n\n### Replacing palette in SVG\n\nThis tool can be used to change colors in SVG or add colors to shapes that are missing color values.\n\n    tools.ChangePalette(svg, {\n        '#ff8000': '#0080ff',\n        '#123': '#234'\n    }).then(svg => {\n        // Variable \"svg\" in result is the same as in first parameter of ChangePalette.\n        // Function changes existing SVG instance \n        console.log('Changed palette');\n    }).catch(err => {\n        console.log(err);\n    });\n\nCode above will change #ff8000 to #0080ff and #123 to #234. \n\nBut there are more options:\n\n    tools.ChangePalette(svg, 'red').then(svg => {\n        console.log('Added palette to elements without palette');\n    }).catch(err => {\n        console.log(err);\n    });\n\nCode above will add color \"red\" to all elements that do not have color. It is identical to this:\n\n    tools.ChangePalette(svg, {\n        add: 'red'\n    }).then(svg => {\n        console.log('Added palette to elements without palette');\n    }).catch(err => {\n        console.log(err);\n    });\n\nYou can also change all colors by using keyword \"default\":\n\n    tools.ChangePalette(svg, {\n        default: 'green'\n    }).then(svg => {\n        console.log('Changed all colors to green');\n    }).catch(err => {\n        console.log(err);\n    });\n\nOr you can combine all those attributes:\n\n    tools.ChangePalette(svg, {\n        default: 'green',\n        add: '#000',\n        '#123': '#234\n    }).then(svg => {\n        console.log('Changed all colors to green, except for #123 that was changed to #234, added black color to elements without color');\n    }).catch(err => {\n        console.log(err);\n    });\n\nPrimary use of this tool in SimpleSVG is to replace all colors in monotone with \"currentColor\" keyword and add it to shapes that are missing color values:\n\n    collection.promiseAll(svg => tools.ChangePalette(svg, {\n        default: 'primaryColor',\n        add: 'primaryColor'\n    })).then(() => {\n        console.log('Changed color to primaryColor');\n    }).catch(err => {\n        console.log(err);\n    });\n\n## Indexing shapes and getting shape lengths\n\nIf you are doing stroke animations, you might need to index shapes (add unique class names for them to apply different\nanimations to different shapes) and get length of those shapes.\n\ntools.IndexShapes adds custom attribute to all shapes:\n\n    tools.IndexShapes(svg, {\n        // Attribute to set\n        shapeAttribute: 'data-shape-index',\n        // Attribute value. {index} is replaced with index, incrementing with each shape\n        shapeAttributeValue: '{index}',\n    }).then(shapesCount => {\n        console.log('Added data-shape-index attribute to ' + shapesCount + ' shapes.');\n    }).catch(err => {\n        console.log(err);\n    });\n\nYou can also get those shapes by setting option returnNodes to true. Instead of number of shapes Promise will return\narray of nodes. Each node is cheerio node object. See cheerio documentation for details. \n\ntools.ShapeLengths counts lengths of all shapes. It also returns all nodes, so you can change shapes (add/remove \nattributes or class name):\n\n    tools.ShapeLength(svg).then(results => {\n        console.log('Found ' + results.length + ' shapes:');\n        results.forEach(result => {\n            console.log('Shape ' + result.$node.get(0).tagName + ' has length of ' + result.length);\n        });\n    }).catch(err => {\n        console.log(err);\n    });\n\n## Sample\n\nIn directory \"sample\" you will find a sample script that parses the directory of SVG images. It optimizes images, exports\nthem as optimized SVG images and as JSON collection.\n\n## More tools\n\nIf you need any other tool to help with custom SVG icon sets development, suggest it by opening an issue on GitHub repository.\n\n## License\n\nLibrary is released with MIT license.\n\n© 2016, 2017 Vjacheslav Trushkin\n",
  "readmeFilename": "README.md",
  "scripts": {
    "test": "mocha tests/**/*_test.js"
  },
  "version": "1.1.12"
}
